# Tensor Flow Programming

We will use pretrained deep learning model to classify what's in a photo. A dataset with dog pictures is given and we try to tell the breed of the dog.

* We have picked up a few image files to test our model and we put file paths in a list and then use join function from python OS to append filename to the diractory

### Choose images to work with

```python

from os.path import join
 image_dir = '../input/dog-breed-identification/train/'
 img_paths = [join(image_dir, filename) for filename in 
                                             ['0c8fe33bd89646b678f6b2891df8a1c6.jpg',
                                              '0c3b282ecbed1ca9eb17de4cb1b6e326.jpg',
                                              '04fb4d719e9fe2b6ffe32d9ae7be8a22.jpg',
                                              '0e79be614f12deb4f7cae18614b7391b.jpg']]
                                            
```

* Now we need some pre processing to go from image image file path to something we can run through our model. We'll put all those pre-processing in a single file called read and prep images.
* We load images using load image function.
* Model we are gonna use was trained for 224 cross 224 images. We thus use target_size argument to specify the size of image we want in pixel resolution.
* Then we convert each image to an array using img_to_array function by numpy (just defined here).
* Colour images give us 3D tensors. Stacking multiple of them results in 4D tensors.
* Finally we use a function called as pre precess input  which does some arithmetic on pixel values, spcifically converting them to in between -1 and 1

### Function to read an prep images for modeling

```python
import numpy as np
from tensorflow.python.keras.applications.resnet50 import preprocess_input
form tensorflow.python.keras.preprocessing.image import load_img, img_to_array

image_size = 224

def read_and_prep_images(img_paths, img_height = image_size, img_width = image_size):
    imgs = [load_img(img_path, target_size = (img_height, img_width)) for img_path in img_paths]
    img_array = np.array([img_to_array(img) for img in imgs])
    output = preprocess_input(img_array)
    return(output)
    
```    
























                                              









































