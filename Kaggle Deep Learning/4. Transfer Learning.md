# Transfer Learning

Everything is in comments

```python

from tensorflow.python.keras.applications import ResNet50
from tensorflow.python.keras.models import Sequential  # we'll have a model that is sequence of layers
from tensorflow.python.keras.layers import Dense, Flatten, GlobalAveragePooling2D  # Dense layer 

num_classes = 2 # number of classes we want to distinguish in last layer, rural and urban in this case
resnet_weights_path = '../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'   

my_new_model = Sequential()
my_new_model.add(ResNet50(include_top=False, pooling='avg', weights=resnet_weights_path)) # We add the layers of ResNet except for the top layer that makes predictions
                                                                                          # pooling avg means to convert the second last layer in a vector if it is a higher dimension tensor by averaging.

my_new_model.add(Dense(num_classes, activation='softmax')) # softmax converts raw numbers to probability 

# Say not to train first layer (ResNet) model. It is already trained
my_new_model.layers[0].trainable = False # So basically we have two layers, one is ResNet(which has lot of layers inside it) and other is Dense, which we want to train.

```































